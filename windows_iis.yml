---
- name: install iis
  win_feature:
    name: Web-Server
    state: present
  notify: iis_running

- name: Insert webpage formatting
  win_copy:
    src: website/
    dest: C:\Inetpub\wwwroot\

- name: Copy Cert
  win_copy:
    src: /certs/shadowman_cert.cer
    dest: C:\Inetpub\wwwroot\cert.cert

- name: install certificate 
  win_certificate_store:
    path: C:\Inetpub\wwwroot\cert.cert
    state: present
  register: thumbprint

- name: Add a HTTPS binding
  win_iis_webbinding:
    name: Default Web Site
    protocol: https
    port: 443
    certificate_hash: "{{ thumprint.thumbprints[0] }}"
    state: present
             
#Need to verify when switching to collections
- name: Insert Index Page for webpage
  win_template:
    src: templates/indexcomplex.html.j2
    dest: C:\Inetpub\wwwroot\index.html
  tags:
    - updatewin   
